{% extends 'layout.html' %}

{% block body %}
  <h1>URLs</h1>
  <div class="col-lg-8 px-0">
    {% for file in files %}
      <div class="my-2">
        <table class="table table-bordered table-striped">
          <thead>
            <tr>
              <th>Organisation</th>
              <th>URL</th>
              <th>Sector</th>
            </tr>
          </thead>

          <tbody>
            {% for endpoint in file.endpoints %}
              <tr>
                <td>{{ endpoint['organisation'] }}</td>
                <td>{{ endpoint['url'] }}</td>
                <td>{{ endpoint['sector'] }}</td>
              </tr>
            {% else %}
              <tr>
                <td class="text-center" colspan="3">
                  {% if file['invalid_reason'] %}
                    Invalid CSV: {{ file['invalid_reason'] }}
                  {% else %}
                    File is empty
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
        <pre class="m-0">Source: {{ file['path'] }}</pre>
        {% set filename = file['path'].removeprefix('./base_urls/visit/').removesuffix('.csv') %}
        <a
          href="{{ url_for('edit_urls', filename=filename) }}"
          class="btn btn-primary btn-sm"
          >Edit</a
        >
      </div>
    {% else %}
      No url files found
    {% endfor %}
  </div>
{% endblock %}
